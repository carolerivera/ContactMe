"use strict";function timeToDate(n){var t=Date.parse("1/1/2000 "+n);return n.toString().toLowerCase().indexOf("pm")&&(t+=43200),t}function clearErrorMessages(){var n=$(".error-messages");n.find("h4, ul").empty()}function showErrorMessages(n){clearErrorMessages();$.isArray(n)&&n.length>1?($(".error-messages h4").text("Please fix the following issues, then try again."),$.each(n,function(n,t){$(".error-messages ul").append("<li>"+t+"<\/li>")})):$(".error-messages h4").text(n||"An error occurred, please try again.")}function resetForm(){var n=$("#contact_form"),t;n.find("input[type=radio]").prop("checked",!1);n.find(".captcha-field-wrapper.validated").length?n.find("input[type=text]:not([name=CaptchaCode])").val(""):n.find("input[type=text]").val("");t=n.validate();t.resetForm();clearErrorMessages();$("#FirstName").focus()}function toggleLoading(){var n=$("#contact_form"),t=n.hasClass("loading");t?n.find("input").prop("disabled",!1):n.find("input").prop("disabled",!0);n.toggleClass("loading")}function addValidationMethods(){$.validator.setDefaults({ignore:[]});$.validator.addMethod("time12",function(n,t){var r=$("input[name=AMPM]:checked").val(),i=/^((0?[0-9])|(1[0-2])):[0-5][0-9]$/.test(n);return r?i:this.optional(t)||i},'Enter a 12-hour time such as "12:30".');$.validator.addMethod("hasAmOrPm",function(n){var t=$("input[name=AMPM]:checked").val(),i=n.length;return i?t:!0},"Select AM or PM.");$.validator.addMethod("timeRange",function(n,t,i){var r,u;if(!n.length)return!0;r=n;u=$(".am-pm-wrapper input:checked").val();u&&(r+=" "+u);var e=timeToDate(i[0]),o=timeToDate(i[1]),f=timeToDate(r);return f>=e&&f<=o},function(n){return"Enter a time between "+n[0]+" and "+n[1]+"."});$.validator.addMethod("minuteIncrement",function(n,t,i){var u=Number(i),r=Number(n.substr(n.indexOf(":")+1));return!isNaN(r)&&r%u==0},function(n){return"Enter a time with a "+n+" minute increment."});$.validator.addMethod("phone",function(n,t){return this.optional(t)||/^[0-9 \-+()x.]*$/.test(n)},'Enter a valid phone number such as "555-555-5555".')}$(function(){addValidationMethods();var n=$("#CaptchaCode").get(0);$("#contact_form").validate({onkeyup:!1,errorPlacement:function(n,t){t.attr("name")=="TimeToCall"?n.insertAfter(".am-pm-wrapper"):n.insertAfter(t)},rules:{FirstName:{required:!0,maxlength:40},LastName:{required:!0,maxlength:40},EmailAddress:{required:!0,maxlength:80,email:!0},Telephone:{maxlength:16,phone:!0},TimeToCall:{time12:!0,hasAmOrPm:!0,timeRange:[$("#TimeToCall").data("mintime"),$("#TimeToCall").data("maxtime")],minuteIncrement:$("#TimeToCall").data("minuteinc")},CaptchaCode:{required:!0,remote:{url:"/Contact/ValidateCaptcha",type:"POST",data:{captchaId:n.Captcha.Id,instanceId:n.Captcha.InstanceId,userInput:function(){return n.value}},complete:function(t){if(t.responseJSON){var i=$(".captcha-field-wrapper");i.addClass("validated");i.find("input").removeClass("error").prop("disabled",!0)}else n.Captcha.ReloadImage()}}}},messages:{FirstName:{required:"Enter your first name.",maxlength:"Do not exceed 40 characters."},LastName:{required:"Enter your last name.",maxlength:"Do not exceed 40 characters."},Telephone:{maxlength:"Do not exceed 16 characters."},EmailAddress:{required:"Enter your email address.",email:'Enter a valid email address such as "name@domain.com".',maxlength:"Do not exceed 80 characters."},CaptchaCode:{required:"Enter the code you see above.",remote:"Incorrect code."}},submitHandler:function(t,i){var r,u,f;i.preventDefault();r=$("#TimeToCall").val();r&&r.length&&(u=$("input[name=AMPM]:checked").val(),u&&u.length?$("#BestTimeToCall").val(r+" "+u):$("#BestTimeToCall").val(r));$("#CaptchaId").val(n.Captcha.Id);$("#CaptchaInstanceId").val(n.Captcha.InstanceId);$("#CaptchaCode").prop("disabled",!1);f=$(t).serialize();toggleLoading();$.ajax({type:"POST",url:t.action,data:f,dataType:"json",success:function(t){toggleLoading();t.Success?($("#contact_form").fadeOut().remove(),$("#success").fadeIn()):(showErrorMessages(t.Errors),n.Captcha.ReloadImage())},error:function(){toggleLoading();showErrorMessages("An error occurred, please try again.");n.Captcha.ReloadImage()}})}});$(".am-pm-wrapper input").on("change",function(){$("#TimeToCall").valid()})});